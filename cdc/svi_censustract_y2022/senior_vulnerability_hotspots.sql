-- svi_vulnerable_seniors.sql

-- Purpose: Analyze areas with high concentrations of vulnerable senior populations
-- to help healthcare organizations and emergency planners:
-- - Target preventive healthcare services for seniors
-- - Identify areas needing specialized emergency response plans
-- - Plan locations for senior-focused medical facilities
-- - Optimize resource allocation for aging populations

WITH senior_vulnerability AS (
  SELECT 
    state,
    county,
    location,
    e_totpop,
    e_age65,
    ep_age65,
    ep_uninsur,
    ep_disabl,
    ep_noveh,
    ep_pov150,
    -- Create composite senior vulnerability score
    (ep_age65 * 0.3 + 
     ep_uninsur * 0.2 + 
     ep_disabl * 0.2 + 
     ep_noveh * 0.15 + 
     ep_pov150 * 0.15) as senior_vuln_score
  FROM mimi_ws_1.cdc.svi_censustract_y2022
  WHERE e_totpop >= 100  -- Filter out very small populations
)

SELECT
  state,
  county,
  location,
  e_totpop as total_population,
  e_age65 as senior_population,
  ROUND(ep_age65, 1) as pct_seniors,
  ROUND(ep_uninsur, 1) as pct_uninsured,
  ROUND(ep_disabl, 1) as pct_disabled,
  ROUND(ep_noveh, 1) as pct_no_vehicle,
  ROUND(ep_pov150, 1) as pct_poverty,
  ROUND(senior_vuln_score, 2) as vulnerability_score
FROM senior_vulnerability
WHERE senior_vuln_score >= 50  -- Focus on higher vulnerability areas
ORDER BY senior_vuln_score DESC
LIMIT 100;

-- How it works:
-- 1. Creates a CTE that calculates a weighted vulnerability score based on:
--    - Percentage of seniors (30% weight)
--    - Uninsured rate (20% weight)
--    - Disability rate (20% weight)
--    - No vehicle access (15% weight)
--    - Poverty level (15% weight)
-- 2. Filters for areas with significant populations
-- 3. Returns top 100 most vulnerable areas based on composite score

-- Assumptions and Limitations:
-- - Weights in composite score are subjective and may need adjustment
-- - Census tract level data may mask neighborhood variations
-- - Does not account for proximity to healthcare facilities
-- - Current year data only - no temporal trends

-- Possible Extensions:
-- 1. Add healthcare facility proximity analysis
-- 2. Include temporal analysis to show trending vulnerabilities
-- 3. Add geographic clustering analysis
-- 4. Incorporate additional factors like:
--    - Internet access for telehealth
--    - Public transportation availability
--    - Climate vulnerability
-- 5. Create risk tiers based on score ranges

/*

    - Author: claude-3-5-sonnet-20241022
    - Created At: 2024-11-05T23:03:42.510902
    - Additional Notes: Query uses weighted scoring to identify census tracts with concentrated vulnerable senior populations, combining age demographics with key social risk factors. Best used for initial geographic targeting of senior services and emergency planning. Score weights (30/20/20/15/15) may need adjustment based on local priorities.
    
    */