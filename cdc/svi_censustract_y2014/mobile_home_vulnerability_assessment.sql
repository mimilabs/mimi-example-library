-- mobile_home_vulnerable_populations.sql

-- Business Purpose: 
-- This analysis identifies census tracts with high concentrations of mobile homes and vulnerable populations
-- to support emergency preparedness and disaster response planning. Mobile homes are particularly susceptible
-- to natural disasters like tornadoes and hurricanes, and when combined with vulnerable populations
-- (elderly, disabled, limited English), these areas require special attention for emergency management.

WITH mobile_home_tracts AS (
  -- Identify census tracts with significant mobile home populations
  SELECT 
    state,
    county,
    location,
    e_mobile, -- Count of mobile homes
    ep_mobile, -- Percentage of mobile homes
    e_totpop, -- Total population
    e_age65, -- Elderly population
    e_disabl, -- Disabled population
    e_limeng, -- Limited English population
    e_noveh -- No vehicle households
  FROM mimi_ws_1.cdc.svi_censustract_y2014
  WHERE ep_mobile > 20 -- Focus on areas where >20% of housing units are mobile homes
    AND e_totpop > 100 -- Exclude very small populations
)

SELECT 
  state,
  county,
  location,
  e_mobile AS mobile_home_count,
  ROUND(ep_mobile, 1) AS mobile_home_pct,
  e_totpop AS total_population,
  ROUND(100.0 * e_age65 / e_totpop, 1) AS elderly_pct,
  ROUND(100.0 * e_disabl / e_totpop, 1) AS disabled_pct,
  ROUND(100.0 * e_limeng / e_totpop, 1) AS limited_english_pct,
  ROUND(100.0 * e_noveh / e_totpop, 1) AS no_vehicle_pct
FROM mobile_home_tracts
ORDER BY ep_mobile DESC
LIMIT 100;

-- How the Query Works:
-- 1. Creates CTE to identify census tracts with significant mobile home populations
-- 2. Calculates percentages of vulnerable populations in these areas
-- 3. Returns top 100 tracts ordered by mobile home percentage
-- 4. Rounds percentages to 1 decimal place for readability

-- Assumptions and Limitations:
-- - Uses 20% mobile home threshold (adjustable based on needs)
-- - Excludes tracts with <100 population to avoid small number issues
-- - Based on 2014 data which may be outdated
-- - Does not account for mobile home park quality or disaster preparedness measures

-- Possible Extensions:
-- 1. Add natural disaster risk factors (flood zones, tornado alley, etc.)
-- 2. Include distance to emergency services/shelters
-- 3. Compare with historical disaster impact data
-- 4. Add income/poverty metrics to identify resource constraints
-- 5. Create risk scores based on combined vulnerability factors

/*

    - Author: claude-3-5-sonnet-20241022
    - Created At: 2024-11-06T00:25:23.228310
    - Additional Notes: Query identifies high-risk census tracts based on mobile home density and vulnerable populations. The 20% mobile home threshold and 100-person minimum population filters can be adjusted as needed. Results are useful for emergency management planning and disaster preparedness programs.
    
    */